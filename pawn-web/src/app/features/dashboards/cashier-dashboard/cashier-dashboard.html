<div class="min-h-screen bg-gray-50 dark:bg-gray-900">
  <style>
    /* Custom scrollbar that only appears when needed */
    .custom-scrollbar::-webkit-scrollbar {
      width: 4px;
      height: 4px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
      background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
      background-color: rgba(156, 163, 175, 0.5);
      border-radius: 20px;
    }

    .custom-scrollbar:hover::-webkit-scrollbar-thumb {
      background-color: rgba(156, 163, 175, 0.7);
    }

    /* Custom class for fixed max height */
    .max-h-items {
      max-height: calc(100vh - 180px);
    }
  </style>

  <!-- Dashboard Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex items-center justify-center py-12">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div>
    </div>

    <!-- Transaction Types Section (Transaction Cards) -->
    <div *ngIf="!isLoading"
      class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6">Transaction Types</h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <button *ngFor="let type of transactionTypes" (click)="onTransactionTypeSelect(type)"
          class="flex items-center space-x-3 p-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left hover:shadow-md group">

          <div [class]="'p-3 rounded-lg transition-colors ' + type.bgColor">
            <!-- New Loan Icon -->
            <svg *ngIf="type.icon === 'plus'" class="w-6 h-6" [class]="type.iconColor" fill="none" stroke="currentColor"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6">
              </path>
            </svg>

            <!-- Additional Icon -->
            <svg *ngIf="type.icon === 'plus-circle'" class="w-6 h-6" [class]="type.iconColor" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>

            <!-- Partial Icon -->
            <svg *ngIf="type.icon === 'credit-card'" class="w-6 h-6" [class]="type.iconColor" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
            </svg>

            <!-- Redeem Icon -->
            <svg *ngIf="type.icon === 'check-circle'" class="w-6 h-6" [class]="type.iconColor" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>

            <!-- Renew Icon -->
            <svg *ngIf="type.icon === 'refresh'" class="w-6 h-6" [class]="type.iconColor" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
              </path>
            </svg>

            <!-- Create Appraisal Icon -->
            <svg *ngIf="type.icon === 'clipboard-list'" class="w-6 h-6" [class]="type.iconColor" fill="none"
              stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4">
              </path>
            </svg>
          </div>

          <div class="flex-1">
            <p class="font-medium text-gray-900 dark:text-white group-hover:text-primary-600 transition-colors">{{
              type.title }}</p>
            <p class="text-sm text-gray-500 dark:text-gray-400">{{ type.description }}</p>
          </div>

          <div class="text-gray-400 group-hover:text-primary-600 transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </div>
        </button>
      </div>
    </div>

    <!-- Main Content: Pending Appraisals (Left) and Recent Transactions (Right) -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">

      <!-- Pending Appraisals (Left Side) -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Pending Appraisals</h3>
          <span
            class="bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200 px-2 py-1 rounded-full text-sm font-medium">
            {{ pendingAppraisals.length }} items
          </span>
        </div>

        <div *ngIf="pendingAppraisals.length === 0" class="text-center py-8">
          <div class="text-gray-400 mb-2">
            <svg class="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4">
              </path>
            </svg>
          </div>
          <p class="text-gray-500 dark:text-gray-400">No pending appraisals</p>
          <p class="text-sm text-gray-400 dark:text-gray-500">Completed appraisals will appear here</p>
        </div>

        <div *ngIf="pendingAppraisals.length > 0" class="space-y-4">
          <div *ngFor="let appraisal of pendingAppraisals" (click)="testClickHandler(appraisal)"
            class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-all cursor-pointer hover:border-primary-300 dark:hover:border-primary-600 hover:bg-gray-50 dark:hover:bg-gray-700/50">

            <div class="flex items-start justify-between mb-3">
              <div class="flex-1">
                <h4
                  class="font-medium text-gray-900 dark:text-white text-sm hover:text-primary-600 dark:hover:text-primary-400 transition-colors">
                  {{ appraisal.pawnerName || 'Unknown Pawner' }}
                </h4>
                <p class="text-xs text-gray-500 dark:text-gray-400">ID: {{ appraisal.id }}</p>
              </div>
              <span
                class="bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 px-2 py-1 rounded-full text-xs font-medium">
                Ready
              </span>
            </div>

            <div class="space-y-2 mb-3">
              <div class="flex justify-between text-sm">
                <span class="text-gray-500 dark:text-gray-400">Item:</span>
                <span class="text-gray-900 dark:text-white font-medium">{{ appraisal.itemType || appraisal.description
                  }}</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-500 dark:text-gray-400">Category:</span>
                <span class="text-gray-900 dark:text-white">{{ appraisal.category }}</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-gray-500 dark:text-gray-400">Appraised Value:</span>
                <span class="text-gray-900 dark:text-white font-semibold">{{
                  formatCurrency(getAppraisalValue(appraisal)) }}</span>
              </div>
            </div>

            <div class="flex justify-between items-center pt-3 border-t border-gray-100 dark:border-gray-700">
              <span class="text-xs text-gray-400">
                {{ getTimeAgo(appraisal.createdAt) }}
              </span>
              <span class="text-xs text-primary-600 dark:text-primary-400 font-medium">
                Click to process â†’
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Transactions (Right Side) - Current Transaction -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Recent Transactions</h3>
          <a routerLink="/transactions" class="text-primary-600 hover:text-primary-700 text-sm font-medium">View All</a>
        </div>

        <div class="space-y-4">
          <div *ngFor="let transaction of recentTransactions"
            class="flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-700 last:border-b-0">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center">
                <span class="text-xs font-medium text-primary-600 dark:text-primary-400">
                  {{ transaction.id.slice(-3) }}
                </span>
              </div>
              <div>
                <div class="flex items-center space-x-2 mb-1">
                  <p class="text-sm font-medium text-gray-900 dark:text-white">{{ transaction.customer_name }}</p>
                  <span
                    [class]="'inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ' + getTransactionTypeColor(transaction.type)">
                    {{ getTransactionTypeLabel(transaction.type) }}
                  </span>
                </div>
                <p class="text-xs text-gray-500 dark:text-gray-400">{{ getTimeAgo(transaction.created_at) }}</p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-sm font-medium text-gray-900 dark:text-white">{{ formatCurrency(transaction.amount) }}</p>
              <span
                [class]="'inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ' + getStatusColor(transaction.status)">
                {{ transaction.status | titlecase }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
